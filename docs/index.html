<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysis of single-cell epigenomics datasets with a Shiny App • ChromSCape</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Analysis of single-cell epigenomics datasets with a Shiny App">
<meta property="og:description" content="ChromSCape - Chromatin landscape profiling for Single Cells - is a ready-to-launch user-friendly Shiny Application for the analysis of single-cell epigenomics datasets (scChIP-seq, scATAC-seq, scCUT&amp;Tag, ...) from aligned data to differential analysis &amp; gene set enrichment analysis. It is highly interactive, enables users to save their analysis and covers a wide range of analytical steps: QC, preprocessing, filtering, batch correction, dimensionality reduction, vizualisation, clustering, differential analysis and gene set analysis. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ChromSCape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/vignette.html">Get started</a>
</li>
<li>
  <a href="articles/vignette.html">Examples</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/vignette.html">Vignettes overview</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vallotlab/ChromSCape/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="chromscape" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#chromscape" class="anchor"></a>ChromSCape</h1></div>
<div id="what-is-chromscape-" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-chromscape-" class="anchor"></a>What is ChromSCape ?</h2>
<p><strong>ChromSCape</strong> - Chromatin landscape profiling for Single Cells - is a ready-to-launch user-friendly Shiny Application for the analysis of single-cell epigenomics datasets (scChIP-seq, scATAC-seq, scCUT&amp;Tag, …) from aligned data to differential analysis &amp; gene set enrichment analysis. It is highly interactive, enables users to save their analysis and covers a wide range of analytical steps: QC, preprocessing, filtering, batch correction, dimensionality reduction, vizualisation, clustering, differential analysis and gene set analysis.</p>
<p><a href="https://www.nature.com/articles/s41467-020-19542-x">Prompsy, P., Kirchmeier, P., Marsolier, J. et al. Interactive analysis of single-cell epigenomic landscapes with ChromSCape.<br>
Nat Commun 11, 5702 (2020).</a></p>
</div>
<div id="launching-chromscape" class="section level2">
<h2 class="hasAnchor">
<a href="#launching-chromscape" class="anchor"></a>Launching ChromSCape</h2>
<p><strong>ChromSCape</strong> requires <strong>R version 4.02</strong>. To install <strong>ChromSCape</strong>, open <strong>R</strong> or <strong>Rstudio</strong> and run the following commands :</p>
<pre><code>if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
    
BiocManager::install("ChromSCape")</code></pre>
<p>Once the installation was sucessful, launch <strong>ChromSCape</strong> using the following command :</p>
<pre><code><a href="https://github.com/vallotlab/ChromSCape">library(ChromSCape)
launchApp()</a></code></pre>
<p>It is recommended to use Chrome browser for optimal display of graphics &amp; table. If no browser opens, copy the url after ‘Listening on …’ and paste in your browser.</p>
</div>
<div id="demo" class="section level2">
<h2 class="hasAnchor">
<a href="#demo" class="anchor"></a>Demo</h2>
<p>Checkout the application look &amp; feel at : <a href="https://vallotlab.shinyapps.io/ChromSCape/">Demo</a>. On this demo application, you can follow analysis of Jurkat &amp; Ramos scChIP H3K4me3 cells.</p>
</div>
<div id="user-guide" class="section level2">
<h2 class="hasAnchor">
<a href="#user-guide" class="anchor"></a>User guide</h2>
<p>Take a look at the user guide before starting: <a href="https://vallotlab.github.io/ChromSCape/ChromSCape_guide.html">User guide</a></p>
</div>
<div id="test-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#test-datasets" class="anchor"></a>Test datasets</h2>
<p>ChromSCape takes as input one tab-separated count matrice (in .tsv or .txt) per sample. In order to upload multiple matrices, the matrices should be placed in the same folder of your computer. Before you input your own matrices, it is recommended you try playing around and familiarize with ChromSCape by downloading our example matrices and uploading them in ChromSCape :</p>
<p>Try out ChromSCape with various kind of dataset : <a href="https://www.dropbox.com/sh/vk7umx3ksgoez3x/AACEq9zn-rRbtwf_Al9uEUaQa?dl=0">Dropbox repository</a></p>
</div>
<div id="run-time" class="section level2">
<h2 class="hasAnchor">
<a href="#run-time" class="anchor"></a>Run Time</h2>
<p>On a Intel® Core™ i5-6500 CPU @ 3.20GHz × 4 with 31,3 Gio RAM, the installation took less than one hour. The running time of of scChIP_H3K27me3 test dataset was 25 minutes without peak calling and 35 minutes with peak calling.</p>
</div>
<div id="input" class="section level2">
<h2 class="hasAnchor">
<a href="#input" class="anchor"></a>Input</h2>
<p>The matrix format should be tab-separated file, with Cells as column &amp; Features as rows. The first line should be cell names, the first column should be feature names. Feature names can be either genomic coordinate in the format ‘chr:start-end’ or ‘chr_start_end’ or gene symbols (e.g: A1BG, A1BG-AS1 for hg38 or Rab23, Bag2 for mm10).</p>
</div>
<div id="output" class="section level2">
<h2 class="hasAnchor">
<a href="#output" class="anchor"></a>Output</h2>
<p>The app automatically creates a directory <strong>Chromscape_analysis</strong> in which a new directory is created for each analysis with a different input name. Inside that directory are created a directory for each part of the analysis, containing RData and figures.</p>
</div>
<div id="other" class="section level2">
<h2 class="hasAnchor">
<a href="#other" class="anchor"></a>Other</h2>
<p>The Gene Set Enrichment Analysis is based on MSIG database (<a href="http://software.broadinstitute.org/gsea/msigdb" class="uri">http://software.broadinstitute.org/gsea/msigdb</a>).</p>
</div>
<div id="advanced-requirements-for-optional-peak-calling-step" class="section level2">
<h2 class="hasAnchor">
<a href="#advanced-requirements-for-optional-peak-calling-step" class="anchor"></a>Advanced requirements for optional Peak Calling step</h2>
<p>The peak calling step is important for Gene Set Enrichment Analysis particularly for features defined as genomic bins &gt;= 20kbp or broad peaks. It will aggregate signal of cells in each cluster (‘in-silico cell sorting’) and call peaks separately for each cluster using MACS2 peak caller. Then the annotation of genes to bins is refined and genes TSS not falling closer to 1000bp of any peaks are removed from annotation. This exclude any ‘false’ association of large genomic bins/regions to genes.<br>
This step requires <strong>BAM files</strong> of each sample (one BAM file must contains reads of all cells of a given sample) as input. The user should be on a Unix system (Mac, Linux) and have installed MACS2:</p>
<pre><code>  macs2 2.1.2 (https://github.com/taoliu/MACS)</code></pre>
<p>The application will automatically check if these tools are available and will give you a warning if they are not installed/available.</p>
</div>
<div id="note-for-windows-users" class="section level2">
<h2 class="hasAnchor">
<a href="#note-for-windows-users" class="anchor"></a>Note for Windows users</h2>
<p>Windows user are not able to run the peak calling step, as both and macs2 are not yet available on windows.<br>
Therefore, if users want to run peak calling, they can use the docker version.</p>
</div>
<div id="docker" class="section level2">
<h2 class="hasAnchor">
<a href="#docker" class="anchor"></a>Docker</h2>
<p>A docker image with all dependencies is available at <a href="https://hub.docker.com/repository/docker/pacomito/chromscape">DockerHub</a>. To run the docker image and launch ChromSCape, run :</p>
<pre><code>sudo docker run --rm -p 4747:4747 -v ~/ChromSCape_analyses_docker:/root/output/ -t pacomito/chromscape:v0.0.9001</code></pre>
<p>Explanation:</p>
<ul>
<li>
<code>sudo</code> run with admin rights, a password will be asked</li>
<li>
<code>docker run -t pacomito/chromscape:v0.0.9001</code> download and run the image</li>
<li>
<code>--rm</code> supress container when run ends</li>
<li>
<code>-p 4747:4747</code> expose docker port 4747 to localhost:4747</li>
<li>
<code>-v ~/ChromSCape_analyses_docker:/root/output/</code> output folder where ChromSCape_analyses folder will be created is linked to the container ‘/root/’ folder. Change ‘~/ChromSCape_analyses_docker’ to your preferred output path</li>
</ul>
<p>Optionally, if you want to input BAM, BED of Peak-Index-Barcode files, add another -v option from your local machine directory to the docker container:</p>
<pre><code>-v ~/file_inputs:/root/input</code></pre>
<p>After the downloading of the image and the loading of ChromSCape, navigate to : <a href="http://127.0.0.1:4747">http://127.0.0.1:4747</a></p>
<p>You can change the port number if it is already taken, e.g. port = 5858, by changing the -p option and adding ‘5858’ as final argument :</p>
<pre><code>sudo docker run --rm -p 4747:4747 -v ~/ChromSCape_analyses_docker:/root/output/ -t pacomito/chromscape:v0.0.9001 5858</code></pre>
<p>MACS2 is installed on the Docker image so this is a way to run the peak calling on Windows.</p>
</div>
</div>
<div id="authors" class="section level1">
<h1 class="hasAnchor">
<a href="#authors" class="anchor"></a>Authors</h1>
<p>Please do not hesitate to post an issue or contact the authors :</p>
<p>Celine Vallot : <a href="mailto:celine.vallot@curie.fr" class="email">celine.vallot@curie.fr</a></p>
<p>Pacome Prompsy : <a href="mailto:pacome.prompsy@curie.fr" class="email">pacome.prompsy@curie.fr</a></p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from BIOC at <br><a href="https://www.bioconductor.org/packages/ChromSCape">https://​www.bioconductor.org/​packages/​ChromSCape</a>
</li>
<li>Browse source code at <br><a href="https://github.com/vallotlab/ChromSCape/">https://​github.com/​vallotlab/​ChromSCape/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/vallotlab/ChromSCape/issues">https://​github.com/​vallotlab/​ChromSCape/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Pacome Prompsy <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-4375-7583" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Celine Vallot <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-1601-2359" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Pacome Prompsy, Celine Vallot.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
