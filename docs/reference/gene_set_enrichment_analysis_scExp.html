<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Runs Gene Set Enrichment Analysis on genes associated with differential
features — gene_set_enrichment_analysis_scExp • ChromSCape</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Runs Gene Set Enrichment Analysis on genes associated with differential
features — gene_set_enrichment_analysis_scExp" />
<meta property="og:description" content="This function takes previously calculated differential features and runs
hypergeometric test to look for enriched gene sets in the genes associated
with differential features, for each cell cluster. This functions takes as
input a SingleCellExperiment object with consclust, the type of comparison,
either 'one_vs_rest' or 'pairwise', the adjusted p-value threshold (qval.th)
and the fold-change threshold (cdiff.th). It outputs a SingleCellExperiment
object containing a differential list." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChromSCape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/vignette.html">Get started</a>
</li>
<li>
  <a href="../articles/vignette.html">Examples</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vignette.html">ChromSCape overview</a>
    </li>
    <li>
      <a href="../articles/scCutTag_Bartosovic_H3K27me3.html">scCUT&amp;TAG in the mouse brain</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vallotlab/ChromSCape/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Runs Gene Set Enrichment Analysis on genes associated with differential
features</h1>
    <small class="dont-index">Source: <a href='https://github.com/vallotlab/ChromSCape/blob/master/R/diff_analysis_gene_set_enrichment.R'><code>R/diff_analysis_gene_set_enrichment.R</code></a></small>
    <div class="hidden name"><code>gene_set_enrichment_analysis_scExp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes previously calculated differential features and runs
hypergeometric test to look for enriched gene sets in the genes associated
with differential features, for each cell cluster. This functions takes as
input a SingleCellExperiment object with consclust, the type of comparison,
either 'one_vs_rest' or 'pairwise', the adjusted p-value threshold (qval.th)
and the fold-change threshold (cdiff.th). It outputs a SingleCellExperiment
object containing a differential list.</p>
    </div>

    <pre class="usage"><span class='fu'>gene_set_enrichment_analysis_scExp</span><span class='op'>(</span>
  <span class='va'>scExp</span>,
  enrichment_qval <span class='op'>=</span> <span class='fl'>0.1</span>,
  ref <span class='op'>=</span> <span class='st'>"hg38"</span>,
  GeneSets <span class='op'>=</span> <span class='cn'>NULL</span>,
  GeneSetsDf <span class='op'>=</span> <span class='cn'>NULL</span>,
  GenePool <span class='op'>=</span> <span class='cn'>NULL</span>,
  qval.th <span class='op'>=</span> <span class='fl'>0.01</span>,
  cdiff.th <span class='op'>=</span> <span class='fl'>1</span>,
  peak_distance <span class='op'>=</span> <span class='fl'>1000</span>,
  use_peaks <span class='op'>=</span> <span class='cn'>FALSE</span>,
  GeneSetClasses <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"c1_positional"</span>, <span class='st'>"c2_curated"</span>, <span class='st'>"c3_motif"</span>, <span class='st'>"c4_computational"</span>,
    <span class='st'>"c5_GO"</span>, <span class='st'>"c6_oncogenic"</span>, <span class='st'>"c7_immunologic"</span>, <span class='st'>"hallmark"</span><span class='op'>)</span>,
  progress <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>scExp</th>
      <td><p>A SingleCellExperiment object containing list of differential
features.</p></td>
    </tr>
    <tr>
      <th>enrichment_qval</th>
      <td><p>Adjusted p-value threshold for gene set enrichment.
(0.1)</p></td>
    </tr>
    <tr>
      <th>ref</th>
      <td><p>A reference annotation, either 'hg38' or 'mm10'. ('hg38')</p></td>
    </tr>
    <tr>
      <th>GeneSets</th>
      <td><p>A named list of gene sets. If NULL will automatically load
MSigDB list of gene sets for specified reference genome. (NULL)</p></td>
    </tr>
    <tr>
      <th>GeneSetsDf</th>
      <td><p>A dataframe containing gene sets &amp; class of gene sets. If
NULL will automatically load MSigDB dataframe of gene sets for specified
reference genome. (NULL)</p></td>
    </tr>
    <tr>
      <th>GenePool</th>
      <td><p>The pool of genes to run enrichment in. If NULL will
automatically load Gencode list of genes fro specified reference genome.
(NULL)</p></td>
    </tr>
    <tr>
      <th>qval.th</th>
      <td><p>Adjusted p-value threshold to define differential features.
(0.01)</p></td>
    </tr>
    <tr>
      <th>cdiff.th</th>
      <td><p>Fold change threshold to define differential features. (1)</p></td>
    </tr>
    <tr>
      <th>peak_distance</th>
      <td><p>Maximum distanceToTSS of feature to gene TSS to consider
associated, in bp. (1000)</p></td>
    </tr>
    <tr>
      <th>use_peaks</th>
      <td><p>Use peak calling method (must be calculated beforehand).
(FALSE)</p></td>
    </tr>
    <tr>
      <th>GeneSetClasses</th>
      <td><p>Which classes of MSIGdb to look for.</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>A shiny Progress instance to display progress bar.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a SingleCellExperiment object containing list of enriched
Gene Sets for each cluster, either in depleted features, enriched features
or simply differential features (both).</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"scExp"</span><span class='op'>)</span>

<span class='co'>#Usually recommanding qval.th = 0.01 &amp; cdiff.th = 1 or 2</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='va'>scExp_cf</span> <span class='op'>=</span> <span class='fu'>gene_set_enrichment_analysis_scExp</span><span class='op'>(</span><span class='va'>scExp</span>,
 qval.th <span class='op'>=</span> <span class='fl'>0.4</span>, cdiff.th <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Pacome Prompsy, Celine Vallot.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


